# -*- coding: utf-8 -*-
"""
Created on Mon Jan 25 17:24:22 2021

@author: debdoot
"""
import matplotlib.pyplot as plt
import random as rd
import math

# monte carlo function for calculating the volume of the ellipsoid
# we have used probability of points to be inside the ellipsoid
def MonteCarlo(f,N):
    m=0
    for i in range(N):
        x=1*rd.uniform(-1, 1)
        y=1.5*rd.uniform(-1, 1)
        z=2*rd.uniform(-1, 1)
        if f(x,y,z)<=1:
            m=m+1
    return 2*3*4*m/N

# given ellipsoid equation
def ellipsoid(x,y,z):
     return (x)**2+(y/1.5)**2+(z/2)**2
 
# plot the No. of steps Vs Volume of the ellipsoid and compare with analytical value 
#plot  the No. of steps Vs fractional error graph.A is analytical value of volume   
def plot_montecarlo(f,N):
    x=[]
    y=[]
    
    i=100
    while i<=N:
        x.append(i)
        y.append(MonteCarlo(ellipsoid, i))
        v=[i/12.5663-1 for i in y]
        i=i+100
    z=[12.5663 for j in x]    
    plt.title("No of steps Vs Volume")  
    plt.xlabel("No of steps")  
    plt.ylabel("Volume") 
    plt.plot(x,y,'o-', markersize='2',linewidth='1',label='observed data point')
    plt.plot(x,z,'-', markersize='2',linewidth='1',label='analytical plot')
    plt.legend()
    plt.show()
    
    plt.figure()
    plt.title("No of steps Vs Fractional error")  
    plt.xlabel("No of steps")  
    plt.ylabel("Fractional Error")
    plt.plot(x,v,'o-', markersize='2',linewidth='1')
    plt.show()
    

   
# 3d plotting of the ellipsoid 
def threedplot(f,N):
     X=[]
     Y=[]
     Z=[]
     for i in range(N):        
         x=1*rd.uniform(-1, 1)
         y=1.5*rd.uniform(-1, 1)
         z=2*rd.uniform(-1, 1)
         if f(x,y,z)<=1:
             X.append(x)
             Y.append(y)
             Z.append(z)
      
     fig = plt.figure()
     ax = plt.axes(projection='3d')
     ax.plot3D(X, Y, Z, 'purple')
     ax.set_xlabel('x')
     ax.set_ylabel('y')
     ax.set_zlabel('z')
     ax.set_title('ellipsoid')
     plt.show() 

# calling the functions and using the input we will get the answers
print('No. of Steps\tVolume  ')
print('------------------------------')
for i in range(1,201):
    y=MonteCarlo(ellipsoid , 100*i)
    print('%.5f\t%.5f\t'% (100*i,y) )

# plotting two graphs   
plot_montecarlo(ellipsoid, 50000)  

#3d plot     
threedplot(ellipsoid,10000) 

"""
No. of Steps 	Volume  
------------------------------
100.00000	13.44000	
200.00000	12.60000	
300.00000	12.40000	
400.00000	13.14000	
500.00000	12.57600	
600.00000	13.24000	
700.00000	12.06857	
800.00000	12.93000	
900.00000	12.00000	
1000.00000	13.32000	
1100.00000	12.26182	
1200.00000	12.38000	
1300.00000	12.70154	
1400.00000	12.46286	
1500.00000	13.16800	
1600.00000	12.76500	
1700.00000	12.96000	
1800.00000	12.73333	
1900.00000	13.06105	
2000.00000	12.40800	
2100.00000	12.65143	
2200.00000	12.82909	
2300.00000	12.98087	
2400.00000	12.56000	
2500.00000	12.42240	
2600.00000	12.31385	
2700.00000	12.73778	
2800.00000	12.65143	
2900.00000	12.60414	
3000.00000	12.68000	
3100.00000	12.43355	
3200.00000	12.22500	
3300.00000	12.09455	
3400.00000	12.63529	
3500.00000	12.69943	
3600.00000	12.92667	
3700.00000	12.14919	
3800.00000	12.26526	
3900.00000	12.96000	
4000.00000	12.29400	
4100.00000	12.65561	
4200.00000	12.56000	
4300.00000	12.45209	
4400.00000	12.82909	
4500.00000	12.42133	
4600.00000	12.99130	
4700.00000	12.84255	
4800.00000	12.36000	
4900.00000	12.35755	
5000.00000	12.34080	
5100.00000	12.69647	
5200.00000	12.55385	
5300.00000	12.53434	
5400.00000	12.41333	
5500.00000	12.54545	
5600.00000	12.57857	
5700.00000	12.66947	
5800.00000	12.43448	
5900.00000	12.93966	
6000.00000	12.49600	
6100.00000	12.68066	
6200.00000	12.79355	
6300.00000	12.77333	
6400.00000	12.47250	
6500.00000	12.68308	
6600.00000	12.44727	
6700.00000	12.85612	
6800.00000	12.64235	
6900.00000	12.56696	
7000.00000	12.52114	
7100.00000	12.49014	
7200.00000	12.68333	
7300.00000	12.73644	
7400.00000	12.54162	
7500.00000	12.55680	
7600.00000	12.55895	
7700.00000	12.64208	
7800.00000	12.47385	
7900.00000	12.50734	
8000.00000	12.43500	
8100.00000	12.82667	
8200.00000	12.65561	
8300.00000	12.63036	
8400.00000	12.79714	
8500.00000	12.37553	
8600.00000	12.54419	
8700.00000	12.42759	
8800.00000	12.48545	
8900.00000	12.57438	
9000.00000	12.70400	
9100.00000	12.64615	
9200.00000	12.46957	
9300.00000	12.57032	
9400.00000	12.58468	
9500.00000	12.60632	
9600.00000	12.76500	
9700.00000	12.55670	
9800.00000	12.39673	
9900.00000	12.52848	
10000.00000	12.47040	
10100.00000	12.54178	
10200.00000	12.65176	
10300.00000	12.54524	
10400.00000	12.36692	
10500.00000	12.59429	
10600.00000	12.62038	
10700.00000	12.61234	
10800.00000	12.58000	
10900.00000	12.63413	
11000.00000	12.55855	
11100.00000	12.41297	
11200.00000	12.56786	
11300.00000	12.57133	
11400.00000	12.52842	
11500.00000	12.58643	
11600.00000	12.64966	
11700.00000	12.50462	
11800.00000	12.64881	
11900.00000	12.74420	
12000.00000	12.63600	
12100.00000	12.45620	
12200.00000	12.67279	
12300.00000	12.60293	
12400.00000	12.72774	
12500.00000	12.62400	
12600.00000	12.54667	
12700.00000	12.42898	
12800.00000	12.63375	
12900.00000	12.67349	
13000.00000	12.62400	
13100.00000	12.71267	
13200.00000	12.54364	
13300.00000	12.42045	
13400.00000	12.56418	
13500.00000	12.62933	
13600.00000	12.64765	
13700.00000	12.57635	
13800.00000	12.73913	
13900.00000	12.65266	
14000.00000	12.54857	
14100.00000	12.50383	
14200.00000	12.57972	
14300.00000	12.52867	
14400.00000	12.47667	
14500.00000	12.63228	
14600.00000	12.65589	
14700.00000	12.54367	
14800.00000	12.60973	
14900.00000	12.69584	
15000.00000	12.47680	
15100.00000	12.52450	
15200.00000	12.68053	
15300.00000	12.59451	
15400.00000	12.58909	
15500.00000	12.43200	
15600.00000	12.53692	
15700.00000	12.60994	
15800.00000	12.67291	
15900.00000	12.48755	
16000.00000	12.46050	
16100.00000	12.68273	
16200.00000	12.46519	
16300.00000	12.69791	
16400.00000	12.52829	
16500.00000	12.61964	
16600.00000	12.76916	
16700.00000	12.44982	
16800.00000	12.57857	
16900.00000	12.45160	
17000.00000	12.56329	
17100.00000	12.59228	
17200.00000	12.56512	
17300.00000	12.60763	
17400.00000	12.49931	
17500.00000	12.55817	
17600.00000	12.61364	
17700.00000	12.64542	
17800.00000	12.59326	
17900.00000	12.53631	
18000.00000	12.57733	
18100.00000	12.68552	
18200.00000	12.58154	
18300.00000	12.62164	
18400.00000	12.56609	
18500.00000	12.66162	
18600.00000	12.69290	
18700.00000	12.58781	
18800.00000	12.57064	
18900.00000	12.56000	
19000.00000	12.64168	
19100.00000	12.45990	
19200.00000	12.64375	
19300.00000	12.53347	
19400.00000	12.61485	
19500.00000	12.70892	
19600.00000	12.55224	
19700.00000	12.32162	
19800.00000	12.49333	
19900.00000	12.68623	
20000.00000	12.59880    
"""